<html>
<head>
<title>Subs software change log</title>
<link rel=stylesheet href="subs.css" type="text/css">
</head>
<body>
<h1>Subs software change log</h1>

<p>
This file to records changes to the 'subs' general-purpose
software. Each entry has a date, a list of affected components and
comments.  Look here to see what might have changed since your version
of the software.

<p>
<table>

<tr valign="top"><td><strong>
04/11/08
</strong></td><td><i>
<font color="red">Version 1.4.34</font>
</i></td><td>
Various changes have occurred to the formula class as the result of
interfacing with Python.
</td></tr>

<tr valign="top"><td><strong>
26/04/08
</strong></td><td><i>
Several
</i></td><td>
Change to 64-bit and new compiler
</td></tr>

<tr valign="top"><td><strong>
24/04/08
</strong></td><td><i>
<font color="red">Version 1.4.32</font>
</i></td><td>
New version, which builds a shareable as well as a static library.
</td></tr>

<tr valign="top"><td><strong>
14/04/08
</strong></td><td><i>
configure.ac<br>
src/Makefile.am<br>
</i></td><td>
Now using libtool to make a shareable library.
</td></tr>

<tr valign="top"><td><strong>
28/01/08
</strong></td><td><i>
trm_header.cc<br>
<font color="red">Version 1.4.31</font>
</i></td><td>
Found some bugs in the header routines that lead to a crash in ULTRACAM's
'sreduce' fixed.
</td></tr>

<tr valign="top"><td><strong>
25/01/08
</strong></td><td><i>
<font color="red">Version 1.4.30</font>
</i></td><td>
Version release because of memory leak in bsstep.
</td></tr>

<tr valign="top"><td><strong>
24/01/08
</strong></td><td><i>
bsstep.cc
</i></td><td>
Another memory leak; not releasing memory for array x. valgrind
highly recommended.
</td></tr>

<tr valign="top"><td><strong>
22/01/08
</strong></td><td><i>
bsstep.cc
</i></td><td>
Spotted a memory deallocation error with valgrind where I was using
delete instead of delete[]
</td></tr>

<tr valign="top"><td><strong>
02/01/08
</strong></td><td><i>
<font color="red">Version 1.4.29</font>
</i></td><td>
Version release because of switch to pure SLA. I have checked out the 
accuracy with respect to the pulsar timing package 'tempo2' and found maximum 
discrepancies of 100 microsec, which is good enough for me at least. [See the
program 'tcorr' for more info.] You will need to get Pat Wallace's latest
C-version of slalib for this to work. SOFA is no longer needed however.
</td></tr>

<tr valign="top"><td><strong>
27/11/07
</strong></td><td><i>
trm_time.h<br>
trm_time.cc<br>
trm_position.h<br>
trm_position.cc
</i></td><td>
Changing to ICRS coordinates.
</td></tr>

<tr valign="top"><td><strong>
23/11/07
</strong></td><td><i>
trm_time.cc
</i></td><td>
Started to revert to pure SLA because of Pat Wallace's new version of SLA.
</td></tr>

<tr valign="top"><td><strong>
12/11/07
</strong></td><td><i>
<font color="red">Version 1.4.28</font>
</i></td><td>
Version release because of changes to headers needed for ultracam.
</td></tr>

<tr valign="top"><td><strong>
09/11/07
</strong></td><td>
trm_header.h<br>
trm_header.cc
</td><td>
Added new function 'fullname' to Header::Hnode to return full name of a node
(used by ucm2fits to export to fits).
</td></tr>


<tr valign="top"><td><strong>
12/07/07
</strong></td><td><i>
<font color="red">Version 1.4.27</font>
</i></td><td>
Version release because of changes to headers
</td></tr>

<tr valign="top"><td><strong>
12/07/07
</strong></td><td><i>
trm_header.cc
</i></td><td>
Fixed bug in the new 'move_up' routine.
</td></tr>

<tr valign="top"><td><strong>
06/07/07
</strong></td><td><i>
trm_header.h<br>
trm_header.cc<br>
trm_input.h<br>
trm_input.cc
</i></td><td>
Complete overhaul of the header class. This had been bugging me because of the
impossibility of arranging the header into a nice order owing to the use of the
'map' container. Have moved instead to a home-grown tree structure. Rather
painful change overall but worth it in the end I think. Significant
consequences for ultracam and ponto.
</td></tr>

<tr valign="top"><td><strong>
15/05/07
</strong></td><td><i>
<font color="red">Version 1.4.26</font>
</i></td><td>
Version release to prepare for the upcoming VLT run.
</td></tr>

<tr valign="top"><td><strong>
20/12/06
</strong></td><td><i>
trm_unit.h<br>
trm_unit.cc
</i></td><td>
Added AB mags as a unit.
</td></tr>

<tr valign="top"><td><strong>
20/12/06
</strong></td><td><i>
trm_subs.h
</i></td><td>
Fixed bug in 'polint' template function (not used yet anywhere else so
no problem)
</td></tr>

<tr valign="top"><td><strong>
14/12/06
</strong></td><td><i>
factln.cc
</i></td><td>
Function to compute ln(n!) reasonably fast even for large numbers.
</td></tr>

<tr valign="top"><td><strong>
04/12/06
</strong></td><td><i>
trm_array1d.h
</i></td><td>
Added a function to return a percentile
</td></tr>

<tr valign="top"><td><strong>
22/11/06
</strong></td><td><i>
trm_array1d.h
</i></td><td>
Added a function to return the mean.
</td></tr>

<tr valign="top"><td><strong>
22/11/06
</strong></td><td><i>
string_funcs.cc<br>
<font color="red">Version 1.4.25</font>
</i></td><td>
Minor mod to get the line reader to stop at the end
of input properly, not just at newline characters.
</td></tr>

<tr valign="top"><td><strong>
17/11/06
</strong></td><td><i>
medfilt.cc
</i></td><td>
Subsumed into trm_subs.h as a template function.
</td></tr>

<tr valign="top"><td><strong>
08/11/06
</strong></td><td><i>
trm_aray2d.h
</i></td><td>
Added a step function transform.
</td></tr>

<tr valign="top"><td><strong>
26/10/06
</strong></td><td><i>
<font color="red">Version 1.4.24</font>
</i></td><td>
Making sure I am up to date
</td></tr>

<tr valign="top"><td><strong>
22/08/06
</strong></td><td><i>
<font color="red">Version 1.4.23</font>
</i></td><td>
Update for new routines from Stu
</td></tr>

<tr valign="top"><td><strong>
22/08/06
</strong></td><td><i>
boxcar.cc<br>
numdiff.cc
</i></td><td>
New routines from Stu Littlefair.
</td></tr>

<tr valign="top"><td><strong>
21/08/06
</strong></td><td><i>
<font color="red">Version 1.4.22</font>
</i></td><td>
Update needed because of SOFA stuff. Please note
the need for a new external package. 
</td></tr>

<tr valign="top"><td><strong>
21/08/06
</strong></td><td><i>
trm_time.cc<br>
trm_telescope.cc<br>
trm_position.cc<br>
trm_constants.h<br>
trm_position.h
</i></td><td>
Introduced Stu Littlefair's updates for more accurate timing based upon
the SOFA library. The old SLA-only stuff was only good to ~30 msec; the
SOFA stuff is OK to about 10 microsec which is good enough for ULTRACAM.
The downside is that another piece of external software (SOFA) is needed,
but I have packaged it up with the other stuff that is needed and it is
a quick install.
</td></tr>

<tr valign="top"><td><strong>
16/08/06
</strong></td><td><i>
<font color="red">Version 1.4.21</font>
</i></td><td>
Server up again, so I thought I would bring things up to date.
</td></tr>

<tr valign="top"><td><strong>
31/05/06
</strong></td><td><i>
llsqr.cc
</i></td><td>
Changed to nicer function object formalism rather than template.
</td></tr>

<tr valign="top"><td><strong>
24/05/06
</strong></td><td><i>
several
</i></td><td>
Various changes to do with making things more portable. Particular data types 
defined such as Subs::INT4 for 4-byte integers to allow a more robust binary
file format. 
</td></tr>

<tr valign="top"><td><strong>
17/05/06
</strong></td><td><i>
configure.ac
</i></td><td>
Now does some more meaningful checks and writes a config.h file to avoid all the
-D stuff.
</td></tr>

<tr valign="top"><td><strong>
16/05/06
</strong></td><td><i>
centroid.cc
</i></td><td>
More changes to this routine. Added 'dbrent' in the event that 'rtsafe' fails.
</td></tr>

<tr valign="top"><td><strong>
15/05/06
</strong></td><td><i>
Many
</i></td><td>
Another stack of changes this time to allow byte swapping of binary
input data to allow for transfer between different 'endian' machines.
</td></tr>

<tr valign="top"><td><strong>
12/05/06
</strong></td><td><i>
centroid.cc<br>
rtsafe.cc
</i></td><td>
Found minor bug in 'rtsafe' and changed 'centroid' to use 'rtsafe' as a more
robust method. Timing tests indicate that centroid spends most time on the
initial search for a peak, which requires ~13 CCF computations compared to 
a typical 5 for 'rtsafe', although this may depend on the task in hand.
</td></tr>

<tr valign="top"><td><strong>
11/05/06
</strong></td><td><i>
Many
</i></td><td>
Replacing the operator+ operators to add numbers to strings with a more
explicit conversion function because of a problem encountered by Tariq.
</td></tr>

<tr valign="top"><td><strong>
28/03/06
</strong></td><td><i>
trm_ephem.cc
</i></td><td>
Minor bug in output function
</td></tr>

<tr valign="top"><td><strong>
23/03/06
</strong></td><td><i>
trm_header.cc<br>
<font color="red">Version 1.4.20</font>
</i></td><td>
Changed from using the rather unportable regex to PCRE, the Perl-compatible
regular expression library. This is quite widely used and may well be installed
on many systems, although it is easy to install if not.
</td></tr>

<tr valign="top"><td><strong>
23/03/06
</strong></td><td><i>
ran4<br>
gauss4<br>
poisson4
</i></td><td>
Implemented 'ran4' from Numerical Recipes as yet another alternative random
number generator.
</td></tr>

<tr valign="top"><td><strong>
21/03/06
</strong></td><td><i>
Lots<br>
<font color="red">Version 1.4.19</font>
</i></td><td>
Filename changes to get rid of any case sensitivity. Also adding trm_ to headers
and corresponding code files to reduce chances of name clashed with systems
headers. I expect a few bugs to be caused by this, but they should be easily fixable.
</td></tr>

<tr valign="top"><td><strong>
04/03/06
</strong></td><td><i>
Ephem.h<br>
Ephem.ccc<br>
Binary.h<br>
Binary.cc<br>
Star.h<br>
Star.cc
</i></td><td>
Modified to store the type of ephemeris and added routine to compute 
uncertainty in time for a given phase.
</td></tr>

<tr valign="top"><td><strong>
02/03/06
</strong></td><td><i>
Array2D.h<br>
<font color="red">Version 1.4.18</font>
</i></td><td>
Fixed some bugs in the centile routines that were causing problems with
the ultracam plot level selection.
</td></tr>

<tr valign="top"><td><strong>
09/02/06
</strong></td><td><i>
<font color="red">Version 1.4.17</font>
</i></td><td>
New version distributed; think I screwed up with 1.4.16
</td></tr>

<tr valign="top"><td><strong>
24/01/06
</strong></td><td><i>
Units.cc
</i></td><td>
Fixed a couple of bugs in the Units class; minor impact.
</td></tr>

<tr valign="top"><td><strong>
21/01/06
</strong></td><td><i>
Fraction.cc
</i></td><td>
Fixed bug in equality operator
</td></tr>

<tr valign="top"><td><strong>
20/01/06
</strong></td><td><i>
extinct.cc
</i></td><td>
Added a routine to compute astronomical extinction.
</td></tr>

<tr valign="top"><td><strong>
19/01/06
</strong></td><td><i>
fasper.cc
</i></td><td>
Added a routine to compute amplitude spectra a la Press & Rybicki.
</td></tr>

<tr valign="top"><td><strong>
12/10/05
</strong></td><td><i>
<font color="red">Version 1.4.15</font>
</i></td><td>
New version distributed.
</td></tr>

<tr valign="top"><td><strong>
09/11/05
</strong></td><td><i>
Buffer1D<br>
Array1D
</i></td><td>
Added some functionality to insert and delete elements and also to sort.
</td></tr>

<tr valign="top"><td><strong>
01/11/05
</strong></td><td><i>
poisson.cc
</i></td><td>
New routines for generation of Poisson random numbers
</td></tr>

<tr valign="top"><td><strong>
18/10/05
</strong></td><td><i>
Poly.cc
</i></td><td>
Fixed a bug for computing poly of 1 coefficient
</td></tr>

<tr valign="top"><td><strong>
12/10/05
</strong></td><td><i>
Array2D.h<br>
<font color="red">Version 1.4.14</font>
</i></td><td>
Refined the centile function which was not quite taking the right 
value. Also added a median function.
</td></tr>

<tr valign="top"><td><strong>
04/10/05
</strong></td><td><i>
Poly.h<br>
Poly.cc<br>
Buffer1D.h
</i></td><td>
Added some ASCII I/O functions. These don't work yet; more effort needed.
</td></tr>

<tr valign="top"><td><strong>
19/09/05
</strong></td><td><i>
Array1D.h
</i></td><td>
Added functions to return the value of the k-th smallest element and 
the median.
</td></tr>

<tr valign="top"><td><strong>
01/09/05
</strong></td><td><i>
<font color="red">Version 1.4.13</font>
</i></td><td>
Previous one did not seem to have everything it should 
have had. Actually it did.
</td></tr>

<tr valign="top"><td><strong>
30/08/05
</strong></td><td><i>
<font color="red">Version 1.4.12</font>
</i></td><td>
New version release
</td></tr>

<tr valign="top"><td><strong>
29/08/05
</strong></td><td><i>
Header.h<br>
Header.cc
</i></td><td>
New member function to search for headers based upon regular
expression matching.
</td></tr>

<tr valign="top"><td><strong>
11/08/05
</strong></td><td><i>
lots<br>
<font color="red">Version 1.4.11</font>
</i></td><td>
Realised a way to avoid having template when using Function objects by making
use of inheritance instead. Have therefore changed several routines which use
this method. I think its a much neater solution.
</td></tr>

<tr valign="top"><td><strong>
29/06/05
</strong></td><td><i>
amoeba.cc<br>
<font color="red">Version 1.4.10</font>
</i></td><td>
Simplex minimisation routine
</td></tr>

<tr valign="top"><td><strong>
29/06/05
</strong></td><td><i>
string_funcs.cc
</i></td><td>
Added new functions to translate a string to a double, char, int and bool.
</td></tr>

<tr valign="top"><td><strong>
23/05/05
</strong></td><td><i>
string_funcs.cc<br>
<font color="red">Version 1.4.9</font>
</i></td><td>
Added a new function to strip off trailing white space from a string
</td></tr>

<tr valign="top"><td><strong>
16/05/05
</strong></td><td><i>
Array1D.h<br>
<font color="red">Version 1.4.8</font>
</i></td><td>
Added extra functionality to Array1D
</td></tr>

<tr valign="top"><td><strong>
08/02/05
</strong></td><td><i>
what_colour.cc<br>
subs.h<br>
<font color="red">Version 1.4.7</font>
</i></td><td>
Added 'none' as a possible colout to indicate that nothing should be
plotted.
</td></tr>

<tr valign="top"><td><strong>
08/02/05
</strong></td><td><i>
Lots
</i></td><td>
Changes to account for the more rigorous gcc 3.4.xx
</td></tr>

<tr valign="top"><td><strong>
01/12/04
</strong></td><td><i>
Hitem.cc
</i></td><td>
Increased presision of translation from double and float to string.
</td></tr>

<tr valign="top"><td><strong>
01/12/04
</strong></td><td><i>
Poly.h<br>
Poly.cc<br>
Buffer1D.h<br>
<font color="red">Version 1.4.4</font>
</i></td><td>
New constructors from a vector
</td></tr>

<tr valign="top"><td><strong>
01/12/04
</strong></td><td><i>
Units.h<br>
Units.cc
<font color="red">Version 1.4.3</font>
</i></td><td>
Added two more time units, milliseconds and microseconds.
</td></tr>

<tr valign="top"><td><strong>
01/12/04
</strong></td><td><i>
Telescope.cc
<font color="red">Version 1.4.2</font>
</i></td><td>
Added a few more sites.
</td></tr>

<tr valign="top"><td><strong>
08/10/04
</strong></td><td><i>
<font color="red">Version 1.4.1</font>
</i></td><td>
New version after the various updates.
</td></tr>

<tr valign="top"><td><strong>
08/10/04
</strong></td><td><i>
Poly.h<br>
Poly.cc<br>
rebin.cc
</i></td><td>
rebin function, first attempt.
</td></tr>

<tr valign="top"><td><strong>
17/09/04
</strong></td><td><i>
Buffer1D.h<br>
Buffer2D.h<br>
Array1D.h<br>
Array2D.h<br>
subs.h<br>
svdcmp.cc<br>
many others
</i></td><td>
Rationalising the Buffer and Array classes. Buffer designed to contained
anything; Array is specialised to things that can be added, subtracted etc.
Lots of changes and probably bugs introduced.
</td></tr>

<tr valign="top"><td><strong>
17/09/04
</strong></td><td><i>
gser.cc<br>
gammp.cc<br>
gammq.cc<br>
gammln.cc<br>
gcf.cc<br>
tchi.cc
</i></td><td>
Changed to double precision
</td></tr>

<tr valign="top"><td><strong>
10/09/04
</strong></td><td><i>
Telescope.cc
</i></td><td>
Added Faulkes Maui to list of telescopes
</td></tr>

<tr valign="top"><td><strong>
26/08/04
</strong></td><td><i>
svdcmp.cc<br>
<font color="red">Version 1.3.4</font>
</i></td><td>
Reordered to get inline function to be recognised.
</td></tr>

<tr valign="top"><td><strong>
02/07/04
</strong></td><td><i>
Format.h<br>
Format.cc<br>
<font color="red">Version 1.3.3</font>
</i></td><td>
Added new class to help with formatting output of floating point numbers.
</td></tr>

<tr valign="top"><td><strong>
02/07/04
</strong></td><td><i>
Input.h<br>
Input.cc<br>
<font color="red">Version 1.3.2</font>
</i></td><td>
Added a version of set_default to cope explicitly with the case of changing string ones using fixed character strings such
as "new default" without having to convert explicitly to as string.
</td></tr>

<tr valign="top"><td><strong>
30/06/04
</strong></td><td><i>
llsqr.cc<br>
<font color="red">Version 1.3.1</font>
</i></td><td>
Fixed a bug in the 'slow' rejection mode which was effectively making it the same as the fast rejection
</td></tr>

<tr valign="top"><td><strong>
24/06/04
</strong></td><td><i>
ran.cc
</i></td><td>
Made all the random number generators start consistently.
</td></tr>

<tr valign="top"><td><strong>
18/06/04
</strong></td><td><i>
Hitem.cc<br>
Input.h
</i></td><td>
Fixed bug with skipping positional header items in binary files. Input had a bug which prevented
it from saving boolean variables properly and it was failing to save 'chars' to the global variables
when wanted.
</td></tr>

<tr valign="top"><td><strong>
17/06/04
</strong></td><td><i>
string_funcs.cc
</i></td><td>
Fixed problem that occured when there was no newline at the end of a string.
</td></tr>

<tr valign="top"><td><strong>
04/02/04
</strong></td><td><i>
Fraction.h<br>
Fraction.cc<br>
Units.h<br>
Units.cc<br>
Version 1.3.0
</i></td><td>
Two new classes to handle fractions and physical units.
</td></tr>

<tr valign="top"><td><strong>
04/02/04
</strong></td><td><i>
Hitem.h<br>
Hitem.cc
</i></td><td>
Added 'unsigned char' type
</td></tr>

<tr valign="top"><td><strong>
01/02/04
</strong></td><td><i>
Formula.h<br>
Formula.cc
</i></td><td>
Two new files to do with parsing mathematical expressions.
</td></tr>


<tr valign="top"><td><strong>
27/02/04
</strong></td><td><i>
Input.h<br>
Header.h<br>
header.cc<br>
Input.cc
</i></td><td>
Added new routines to interface with the global defaults file. 
</td></tr>

<tr valign="top"><td><strong>
25/02/04
</strong></td><td><i>
llsqr.cc<br>
llsqr.h
Version 1.2.4
</i></td><td>
Created a new header file for the template versions of llsqr to avoid needing to add to
'subs.h' again.
</td></tr>


<tr valign="top"><td><strong>
24/02/04
</strong></td><td><i>
centroid.cc
</i></td><td>
Improved computation of errors which required adding new arguments to this routine. It now allows
for readout noise, an offset bias and photons/count not equal to 1.
</td></tr>

<tr valign="top"><td><strong>
10/12/03
</strong></td><td><i>
Input.h<br>
Input.cc
</i></td><td>
Added new feature in which the last command to change a variable is indicated by
a comment. May be useful when checking the defaults appropriate to a particular routine.
</td></tr>

<tr valign="top"><td><strong>
10/12/03
</strong></td><td><i>
Header.h<br>
Header.cc
</i></td><td>
Added a destructor to the Header class. Should have had this long ago, but I am not
entirely sure where it would have caused problems.
</td></tr>

<tr valign="top"><td><strong>
29/08/02
</strong></td><td><i>
Input.h<br>
Input.cc
</i></td><td>
Fairly substantial revision of the command-line input class. I have now abolished the distinction between true/false and
other variables, and have fixed severat bugs in how it was working.
</td></tr>


</table>

<p>
<address>
Tom Marsh, Warwick
</address> 
</body>
</html>










